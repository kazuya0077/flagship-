---
import BaseLayout from '../layouts/BaseLayout.astro';
import AspLink from '../components/AspLink.astro';
import { siteConfig } from '../config/site';
import { getRecommendItems } from '../library/microcms';

const items = await getRecommendItems();

const services = [
  {
    title: "無料Slackコミュニティ",
    en: "COMMUNITY",
    desc: "国試合格者に24時間質問できる。同じ目標を持つ学生と一緒に合格を目指せるコミュニティ。",
    image: "/assets/images/feature-slack.jpg",
    href: siteConfig.links.slackJoin,
    external: true,
  },
  {
    title: "学習資産を無料DL",
    en: "RESOURCES",
    desc: "合格者が作ったまとめノート・分析シートを完全無料でダウンロード。効率的な国試対策が可能。",
    image: "/assets/images/feature-resources.jpg",
    href: "/resources",
    external: false,
  },
  {
    title: "おすすめ教材を厳選紹介",
    en: "BOOKS",
    desc: "国試高得点を取った運営者が実際に使った教材だけを厳選。失敗しない教材選びをサポート。",
    image: "/assets/images/feature-community.jpg",
    href: "#books",
    external: false,
  },
];

const stats = [
  { value: "238", unit: "点", label: "講師国試得点" },
  { value: "50", unit: "+", label: "学習資料数" },
  { value: "24", unit: "h", label: "質問回答時間" },
  { value: "98", unit: "%", label: "継続率" },
];

const points = [
  { num: "01", title: "完全無料", desc: "入会費・月会費一切なし。Slackに参加するだけで全コンテンツが使えます。" },
  { num: "02", title: "質問し放題", desc: "24時間365日、国試高得点合格者が丁寧に回答します。" },
  { num: "03", title: "資料DL無料", desc: "合格者のまとめノート・分析シートをすべて無料でダウンロード可能。" },
  { num: "04", title: "月2回勉強会", desc: "国試対策の疑問をリアルタイムで解消できるオンライン勉強会を開催。" },
  { num: "05", title: "仲間と繋がる", desc: "同じ目標を持つPT学生と励まし合い、一緒に合格を目指せます。" },
  { num: "06", title: "合格者運営", desc: "高得点合格者の実体験をもとにした、信頼できる情報だけを発信。" },
];
---

<BaseLayout
  title="FLAGSHIP | PT国試対策・無料学習コミュニティ"
  description="理学療法士国家試験対策の情報サイト。おすすめ教材・学習法・無料Slackコミュニティを提供。合格者運営。"
>

<!-- ========== HERO ========== -->
<section class="hero">
  <!-- background image -->
  <div class="hero__bg">
    <img src="/assets/images/hero-1.jpg" alt="" class="hero__bg-img" />
    <div class="hero__bg-overlay"></div>
  </div>

  <!-- text block at bottom (nijinowa style) -->
  <div class="hero__body">
    <p class="hero__label">PT国試対策 × 無料Slackコミュニティ</p>
    <h1 class="hero__title">
      自走する力を、<br>ここから。
    </h1>
    <p class="hero__desc">
      理学療法士国家試験対策の情報を、無料で。<br>
      おすすめ教材・効率的な学習法と、<strong>無料Slackコミュニティ</strong>を提供。
    </p>
    <div class="hero__actions">
      <a href={siteConfig.links.slackJoin} target="_blank" rel="noopener" class="hero__btn hero__btn--fill">
        無料でコミュニティに参加する
      </a>
      <a href="#books" class="hero__btn hero__btn--line">
        おすすめ教材を見る
      </a>
    </div>
  </div>

  <!-- scroll hint -->
  <div class="hero__scroll-hint">
    <span class="hero__scroll-line"></span>
    <span class="hero__scroll-text">SCROLL</span>
  </div>
</section>

<!-- ========== BANNER TOP ========== -->
<div class="banner-zone">
  <div class="container">
    <p class="banner-label">広告</p>
    <div class="banner-inner banner-inner--lg">
      <!-- 728×90 広告タグをここに挿入 -->
      <div class="banner-placeholder" style="height:90px">広告スペース (728×90)</div>
    </div>
  </div>
</div>

<!-- ========== SERVICES ========== -->
<section id="services" class="section section--white">
  <div class="container">
    <p class="sec-label fade-up">WHAT WE OFFER</p>
    <h2 class="sec-title fade-up d1">FLAGSHIPで<span style="color:var(--primary)">できること</span></h2>
    <p class="sec-sub fade-up d2">国試合格に必要なすべてが、無料で揃っています。</p>

    <div class="service-grid">
      {services.map((s, i) => (
        <a
          href={s.href}
          target={s.external ? '_blank' : undefined}
          rel={s.external ? 'noopener' : undefined}
          class={`service-card fade-up d${i+1}`}
        >
          <div class="service-card__img-wrap">
            <img src={s.image} alt={s.title} loading="lazy" class="service-card__img" />
          </div>
          <div class="service-card__body">
            <small class="service-card__en">{s.en}</small>
            <h3 class="service-card__title">{s.title}</h3>
            <p class="service-card__desc">{s.desc}</p>
            <span class="service-card__more">詳しく見る <span aria-hidden>→</span></span>
          </div>
        </a>
      ))}
    </div>
  </div>
</section>

<!-- ========== ABOUT ========== -->
<section id="about" class="section section--cream">
  <div class="container">
    <div class="about-inner">
      <div class="about__img-col fade-up">
        <div class="about__img-wrap">
          <img src="/assets/images/hero-1.jpg" alt="FLAGSHIP" class="about__img" loading="lazy" />
          <div class="about__img-badge">
            <img src="/assets/images/flagship-logo.svg" alt="" width="48" height="48" />
            <span>FLAGSHIP</span>
          </div>
        </div>
      </div>
      <div class="about__text-col fade-up d2">
        <p class="sec-label" style="text-align:left">ABOUT</p>
        <h2 class="about__title">PTを目指す学生の<br><span style="color:var(--primary)">旗艦</span>として</h2>
        <p>FLAGSHIPは、理学療法士国家試験対策を頑張るすべての学生のためのサイトです。</p>
        <p>国試で高得点を取った運営者が実体験をもとに、おすすめ教材・効率的な学習法を発信。<strong>完全無料のSlackコミュニティ</strong>で、仲間と一緒に合格を目指せます。</p>
        <div class="about__actions">
          <a href={siteConfig.links.slackJoin} target="_blank" rel="noopener" class="btn btn--primary">無料コミュニティに参加する</a>
          <a href="/about" class="btn btn--outline">運営者について</a>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- ========== POINTS ========== -->
<section id="features" class="section section--white">
  <div class="container">
    <p class="sec-label fade-up">COMMUNITY</p>
    <h2 class="sec-title fade-up d1">コミュニティの<span style="color:var(--primary)">6つの特徴</span></h2>
    <div class="points-grid">
      {points.map((p, i) => (
        <div class={`point-card fade-up d${(i%3)+1}`}>
          <span class="point-num">{p.num}</span>
          <h3 class="point-title">{p.title}</h3>
          <p class="point-desc">{p.desc}</p>
        </div>
      ))}
    </div>
  </div>
</section>

<!-- ========== STATS ========== -->
<section class="stats-section">
  <div class="container">
    <div class="stats-grid">
      {stats.map((s, i) => (
        <div class={`stat-item fade-up d${i+1}`}>
          <div class="stat-val">{s.value}<span class="stat-unit">{s.unit}</span></div>
          <div class="stat-lbl">{s.label}</div>
        </div>
      ))}
    </div>
  </div>
</section>

<!-- ========== BANNER MID ========== -->
<div class="banner-zone banner-zone--cream">
  <div class="container">
    <p class="banner-label">広告</p>
    <div class="banner-mid">
      <div class="banner-inner banner-inner--sq">
        <div class="banner-placeholder" style="height:250px">広告 (300×250)</div>
      </div>
      <div class="banner-inner banner-inner--sq">
        <div class="banner-placeholder" style="height:250px">広告 (300×250)</div>
      </div>
    </div>
  </div>
</div>

<!-- ========== BOOKS ========== -->
<section id="books" class="section section--white">
  <div class="container">
    <p class="sec-label fade-up">RECOMMEND</p>
    <h2 class="sec-title fade-up d1">おすすめ<span style="color:var(--primary)">教材</span></h2>
    <p class="sec-sub fade-up d2">国試高得点合格者が実際に使った教材を厳選紹介。</p>
    <div class="books-grid">
      {items.map(item => (
        <AspLink
          title={item.title}
          description={item.description}
          links={item.links}
          image={item.image}
        />
      ))}
    </div>
  </div>
</section>

<!-- ========== GALLERY ========== -->
<div class="gallery-strip">
  <div class="gallery-track">
    <img src="/assets/images/hero-1.jpg" alt="" loading="lazy" />
    <img src="/assets/images/feature-slack.jpg" alt="" loading="lazy" />
    <img src="/assets/images/feature-resources.jpg" alt="" loading="lazy" />
    <img src="/assets/images/feature-community.jpg" alt="" loading="lazy" />
    <!-- duplicate for seamless loop -->
    <img src="/assets/images/hero-1.jpg" alt="" loading="lazy" aria-hidden="true" />
    <img src="/assets/images/feature-slack.jpg" alt="" loading="lazy" aria-hidden="true" />
    <img src="/assets/images/feature-resources.jpg" alt="" loading="lazy" aria-hidden="true" />
    <img src="/assets/images/feature-community.jpg" alt="" loading="lazy" aria-hidden="true" />
  </div>
</div>

<!-- ========== CTA ========== -->
<section class="cta-section">
  <div class="container">
    <div class="cta-inner fade-up">
      <p class="cta-label">JOIN US</p>
      <h2 class="cta-title">
        無料Slackコミュニティで<br>
        一緒に合格を目指そう
      </h2>
      <ul class="cta-list">
        <li><span class="cta-check">✓</span> 入会費・月会費：<strong>完全無料</strong></li>
        <li><span class="cta-check">✓</span> 国試合格者への質問し放題</li>
        <li><span class="cta-check">✓</span> 学習資料・まとめノートの無料DL</li>
        <li><span class="cta-check">✓</span> 月2回オンライン勉強会参加</li>
      </ul>
      <a href={siteConfig.links.slackJoin} target="_blank" rel="noopener" class="cta-btn">
        Slackに無料参加する →
      </a>
    </div>
  </div>
</section>

<!-- ========== BANNER BOTTOM ========== -->
<div class="banner-zone">
  <div class="container">
    <p class="banner-label">広告</p>
    <div class="banner-inner banner-inner--lg">
      <div class="banner-placeholder" style="height:90px">広告スペース (728×90)</div>
    </div>
  </div>
</div>

</BaseLayout>

<style>
/* ===== HERO ===== */
.hero {
  position: relative;
  height: 100svh;
  min-height: 600px;
  display: flex;
  align-items: flex-end;
  overflow: hidden;
}

.hero__bg {
  position: absolute;
  inset: 0;
}

.hero__bg-img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  object-position: center 25%;
}

.hero__bg-overlay {
  position: absolute;
  inset: 0;
  background: linear-gradient(
    to top,
    rgba(20, 20, 20, 0.82) 0%,
    rgba(20, 20, 20, 0.4) 50%,
    rgba(20, 20, 20, 0.15) 100%
  );
}

.hero__body {
  position: relative;
  z-index: 1;
  padding: 0 60px 72px;
  max-width: 780px;
}

@media (max-width: 768px) {
  .hero__body { padding: 0 24px 60px; }
}

.hero__label {
  display: inline-block;
  font-size: 0.72rem;
  font-family: 'Montserrat', sans-serif;
  font-weight: 600;
  letter-spacing: 0.18em;
  color: rgba(255,255,255,0.7);
  border: 1px solid rgba(255,255,255,0.3);
  padding: 5px 14px;
  border-radius: 2px;
  margin-bottom: 24px;
}

.hero__title {
  font-size: 3rem;
  font-weight: 800;
  color: #FFFFFF;
  line-height: 1.2;
  letter-spacing: 0.05em;
  margin-bottom: 20px;
}

@media (min-width: 768px) {
  .hero__title { font-size: 4.2rem; }
}

.hero__desc {
  font-size: 0.95rem;
  color: rgba(255,255,255,0.8);
  line-height: 1.9;
  margin-bottom: 32px;
}

.hero__desc strong { color: #FFD580; }

.hero__actions {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
}

.hero__btn {
  display: inline-flex;
  align-items: center;
  padding: 14px 32px;
  font-size: 0.88rem;
  font-weight: 700;
  text-decoration: none;
  letter-spacing: 0.04em;
  transition: all 0.25s ease;
  border-radius: 4px;
}

.hero__btn--fill {
  background: #F06846;
  color: white;
}

.hero__btn--fill:hover { background: #D44D2E; transform: translateY(-1px); }

.hero__btn--line {
  background: transparent;
  border: 1.5px solid rgba(255,255,255,0.5);
  color: white;
}

.hero__btn--line:hover { border-color: white; background: rgba(255,255,255,0.08); }

.hero__scroll-hint {
  position: absolute;
  right: 40px;
  bottom: 40px;
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: 8px;
  z-index: 1;
}

.hero__scroll-line {
  display: block;
  width: 1px;
  height: 60px;
  background: linear-gradient(to bottom, transparent, rgba(255,255,255,0.6));
  animation: scrollLine 2s ease infinite;
}

.hero__scroll-text {
  font-family: 'Montserrat', sans-serif;
  font-size: 0.6rem;
  letter-spacing: 0.2em;
  color: rgba(255,255,255,0.5);
  writing-mode: vertical-rl;
}

@keyframes scrollLine {
  0%, 100% { opacity: 0.3; transform: scaleY(0.7); }
  50% { opacity: 1; transform: scaleY(1); }
}

/* ===== SERVICES ===== */
.service-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 0;
}

@media (min-width: 768px) {
  .service-grid { grid-template-columns: repeat(3, 1fr); }
}

.service-card {
  display: flex;
  flex-direction: column;
  text-decoration: none;
  background: #fff;
  border: 1px solid var(--border);
  transition: box-shadow 0.3s ease, transform 0.3s ease;
  cursor: pointer;
}

.service-card:hover {
  box-shadow: var(--shadow-hover);
  transform: translateY(-4px);
  z-index: 1;
}

.service-card__img-wrap {
  overflow: hidden;
  aspect-ratio: 4/3;
}

.service-card__img {
  width: 100%;
  height: 100%;
  object-fit: cover;
  transition: transform 0.5s ease;
  display: block;
}

.service-card:hover .service-card__img { transform: scale(1.04); }

.service-card__body {
  padding: 28px 24px 32px;
  flex: 1;
  display: flex;
  flex-direction: column;
}

.service-card__en {
  font-family: 'Montserrat', sans-serif;
  font-size: 0.65rem;
  font-weight: 600;
  letter-spacing: 0.2em;
  color: var(--primary);
  margin-bottom: 10px;
}

.service-card__title {
  font-size: 1.05rem;
  font-weight: 700;
  color: #313131;
  margin-bottom: 12px;
  letter-spacing: 0.04em;
}

.service-card__desc {
  font-size: 0.85rem;
  color: var(--text-light);
  line-height: 1.75;
  flex: 1;
  margin: 0;
}

.service-card__more {
  margin-top: 20px;
  font-size: 0.8rem;
  font-weight: 700;
  color: var(--primary);
  display: flex;
  align-items: center;
  gap: 4px;
}

/* ===== ABOUT ===== */
.about-inner {
  display: grid;
  grid-template-columns: 1fr;
  gap: 60px;
  align-items: center;
}

@media (min-width: 768px) {
  .about-inner { grid-template-columns: 1fr 1fr; }
}

.about__img-wrap {
  position: relative;
}

.about__img {
  width: 100%;
  aspect-ratio: 4/3;
  object-fit: cover;
  display: block;
}

.about__img-badge {
  position: absolute;
  bottom: -20px;
  right: -20px;
  background: #FFFFFD;
  border: 1px solid var(--border);
  box-shadow: var(--shadow-card);
  padding: 14px 18px;
  display: flex;
  align-items: center;
  gap: 10px;
  font-weight: 800;
  font-size: 0.9rem;
  color: #313131;
  letter-spacing: 0.1em;
  font-family: 'Montserrat', sans-serif;
}

.about__title {
  font-size: 1.8rem;
  font-weight: 700;
  line-height: 1.4;
  letter-spacing: 0.05em;
  margin-bottom: 20px;
}

.about__actions {
  display: flex;
  flex-wrap: wrap;
  gap: 12px;
  margin-top: 28px;
}

/* ===== POINTS ===== */
.points-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 1px;
  background: var(--border);
  border: 1px solid var(--border);
}

@media (min-width: 600px) {
  .points-grid { grid-template-columns: repeat(2, 1fr); }
}

@media (min-width: 900px) {
  .points-grid { grid-template-columns: repeat(3, 1fr); }
}

.point-card {
  background: #fff;
  padding: 36px 32px;
  transition: background 0.2s ease;
}

.point-card:hover { background: #FFFDF9; }

.point-num {
  display: block;
  font-family: 'Montserrat', sans-serif;
  font-size: 1.8rem;
  font-weight: 800;
  color: var(--primary);
  opacity: 0.35;
  line-height: 1;
  margin-bottom: 14px;
  letter-spacing: -0.02em;
}

.point-title {
  font-size: 1rem;
  font-weight: 700;
  color: #313131;
  margin-bottom: 10px;
  letter-spacing: 0.04em;
}

.point-desc {
  font-size: 0.83rem;
  color: var(--text-light);
  line-height: 1.75;
  margin: 0;
}

/* ===== STATS ===== */
.stats-section {
  background: #2C3E50;
  padding: 72px 0;
}

.stats-grid {
  display: grid;
  grid-template-columns: repeat(2, 1fr);
  gap: 48px;
}

@media (min-width: 768px) {
  .stats-grid { grid-template-columns: repeat(4, 1fr); }
}

.stat-item { text-align: center; }

.stat-val {
  font-size: 3.2rem;
  font-weight: 800;
  color: white;
  font-family: 'Montserrat', sans-serif;
  line-height: 1;
  margin-bottom: 10px;
}

.stat-unit {
  font-size: 1.2rem;
  color: rgba(255,255,255,0.7);
  margin-left: 2px;
}

.stat-lbl {
  font-size: 0.8rem;
  color: rgba(255,255,255,0.55);
  font-weight: 600;
  letter-spacing: 0.1em;
}

/* ===== GALLERY ===== */
.gallery-strip {
  overflow: hidden;
  line-height: 0;
  background: #111;
}

.gallery-track {
  display: flex;
  animation: galleryScroll 28s linear infinite;
  width: max-content;
}

.gallery-track img {
  width: 280px;
  height: 186px;
  object-fit: cover;
  opacity: 0.72;
  transition: opacity 0.3s ease;
  display: block;
  flex-shrink: 0;
  margin-right: 3px;
}

.gallery-track img:hover { opacity: 1; }

@keyframes galleryScroll {
  0%   { transform: translateX(0); }
  100% { transform: translateX(-50%); }
}

/* ===== CTA SECTION ===== */
.cta-section {
  background: #FAF5EB;
  padding: 100px 0;
  border-top: 1px solid var(--border);
}

.cta-inner {
  text-align: center;
  max-width: 600px;
  margin: 0 auto;
}

.cta-label {
  font-family: 'Montserrat', sans-serif;
  font-size: 0.72rem;
  font-weight: 600;
  letter-spacing: 0.22em;
  color: var(--primary);
  margin-bottom: 16px;
}

.cta-title {
  font-size: 1.9rem;
  font-weight: 700;
  color: #313131;
  line-height: 1.4;
  letter-spacing: 0.05em;
  margin-bottom: 36px;
}

@media (min-width: 768px) {
  .cta-title { font-size: 2.3rem; }
}

.cta-list {
  list-style: none;
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 44px;
  text-align: left;
  display: inline-flex;
}

.cta-list li {
  font-size: 0.92rem;
  color: var(--text-light);
}

.cta-list strong { color: #313131; font-weight: 700; }

.cta-check {
  color: var(--primary);
  font-weight: 700;
  margin-right: 6px;
}

.cta-btn {
  display: inline-flex;
  align-items: center;
  padding: 16px 48px;
  background: #F06846;
  color: white;
  font-size: 1rem;
  font-weight: 700;
  letter-spacing: 0.05em;
  text-decoration: none;
  border-radius: 4px;
  transition: all 0.25s ease;
  box-shadow: 6px 6px 9px rgba(240,104,70,0.2);
}

.cta-btn:hover {
  background: #D44D2E;
  transform: translateY(-2px);
  box-shadow: 8px 12px 20px rgba(240,104,70,0.25);
}

/* ===== BOOKS ===== */
.books-grid {
  display: grid;
  grid-template-columns: 1fr;
  gap: 20px;
}

@media (min-width: 640px) {
  .books-grid { grid-template-columns: repeat(2, 1fr); }
}

@media (min-width: 900px) {
  .books-grid { grid-template-columns: repeat(3, 1fr); }
}

/* ===== BANNER ===== */
.banner-zone {
  padding: 14px 0;
  background: #f5f5f3;
  border-top: 1px solid var(--border);
  border-bottom: 1px solid var(--border);
}

.banner-zone--cream { background: var(--bg-cream); }

.banner-label {
  font-size: 0.68rem;
  color: #AEAEAE;
  text-align: center;
  margin-bottom: 6px;
}

.banner-inner { display: flex; justify-content: center; }

.banner-inner--lg { max-width: 728px; width: 100%; margin: 0 auto; }

.banner-inner--sq { width: 300px; }

.banner-mid {
  display: flex;
  flex-wrap: wrap;
  gap: 16px;
  justify-content: center;
}

.banner-placeholder {
  width: 100%;
  background: #e8e8e8;
  border: 2px dashed #ccc;
  display: flex;
  align-items: center;
  justify-content: center;
  color: #aaa;
  font-size: 0.72rem;
  font-weight: 600;
}
</style>

<script>
  document.body.classList.add('loaded');

  const observer = new IntersectionObserver(entries => {
    entries.forEach(e => {
      if (e.isIntersecting) {
        e.target.classList.add('visible');
        observer.unobserve(e.target);
      }
    });
  }, { threshold: 0.08 });

  document.querySelectorAll('.fade-up, .scroll-fade-up').forEach(el => observer.observe(el));
</script>
